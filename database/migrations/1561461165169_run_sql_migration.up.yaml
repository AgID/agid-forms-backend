- args:
    cascade: false
    sql: "CREATE OR REPLACE FUNCTION public.increment_version() RETURNS trigger\r\n
      \   LANGUAGE plpgsql\r\n    AS $$\r\nBEGIN\r\n  IF (TG_OP = 'UPDATE') THEN\r\n
      \   RAISE NOTICE 'Calling version(%)', NEW.version;\r\n    IF NEW.version <
      OLD.version THEN\r\n        RAISE EXCEPTION 'Cannot update an old revision,
      content was already modified by another transaction (latest=%)', OLD.version\r\n
      \       USING HINT = 'Try to load the latest version (%) of the content before
      saving again';\r\n    ELSIF NEW.version > OLD.version THEN\r\n        RAISE
      EXCEPTION 'Cannot update current revision with a wrong version (latest=%)',
      OLD.version \r\n        USING HINT = 'When updating set the current version
      of the content';\r\n    ELSIF NEW.version IS NULL THEN\r\n        RAISE EXCEPTION
      'Cannot update current revision without provinding a version (latest=%)', OLD.version
      \r\n        USING HINT = 'When updating set the current version of the content';\r\n
      \   END IF;\r\n    NEW.version = OLD.version + 1;\r\n    RETURN NEW;\r\n  END
      IF;\r\nEND;\r\n$$;\r\n"
  type: run_sql
